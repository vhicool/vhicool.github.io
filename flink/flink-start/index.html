<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>flink 开始 | 二九的博客</title><meta name="author" content="vhicool"><meta name="copyright" content="vhicool"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="快速开始1. 基于flink DataStream flink本身提供了丰富的数据读取、转换、写入api，我们可以创建DataStream，并对DataStream进行处理，实现数据处理  运行环境  java8  flink-12.2  maven Flink仓库 1234567891011121314151617 &lt;properties&gt;        &lt;flink.vers">
<meta property="og:type" content="article">
<meta property="og:title" content="flink 开始">
<meta property="og:url" content="http://example.com/flink/flink-start/index.html">
<meta property="og:site_name" content="二九的博客">
<meta property="og:description" content="快速开始1. 基于flink DataStream flink本身提供了丰富的数据读取、转换、写入api，我们可以创建DataStream，并对DataStream进行处理，实现数据处理  运行环境  java8  flink-12.2  maven Flink仓库 1234567891011121314151617 &lt;properties&gt;        &lt;flink.vers">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/dog.jpeg">
<meta property="article:published_time" content="2025-06-30T15:17:43.000Z">
<meta property="article:modified_time" content="2025-07-02T13:53:31.943Z">
<meta property="article:author" content="vhicool">
<meta property="article:tag" content="java">
<meta property="article:tag" content="flink">
<meta property="article:tag" content="大数据">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/dog.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "flink 开始",
  "url": "http://example.com/flink/flink-start/",
  "image": "http://example.com/img/dog.jpeg",
  "datePublished": "2025-06-30T15:17:43.000Z",
  "dateModified": "2025-07-02T13:53:31.943Z",
  "author": [
    {
      "@type": "Person",
      "name": "vhicool",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/flink/flink-start/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'flink 开始',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">二九的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">flink 开始</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">flink 开始</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-30T15:17:43.000Z" title="发表于 2025-06-30 23:17:43">2025-06-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-02T13:53:31.943Z" title="更新于 2025-07-02 21:53:31">2025-07-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/flink/">flink</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h1><h2 id="1-基于flink-DataStream"><a href="#1-基于flink-DataStream" class="headerlink" title="1. 基于flink DataStream"></a>1. 基于flink DataStream</h2><blockquote>
<p>flink本身提供了丰富的数据读取、转换、写入api，我们可以创建DataStream，并对DataStream进行处理，实现数据处理</p>
</blockquote>
<p><strong>运行环境</strong></p>
<ul>
<li><p>java8</p>
</li>
<li><p>flink-12.2</p>
</li>
<li><p>maven</p>
<p><a target="_blank" rel="noopener" href="https://repo1.maven.org/maven2/org/apache/flink/">Flink仓库</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flink.version</span>&gt;</span>1.12.2<span class="tag">&lt;/<span class="name">flink.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scala.binary.version</span>&gt;</span>2.11<span class="tag">&lt;/<span class="name">scala.binary.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-clients_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-streaming-java_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>案例</strong></p>
<blockquote>
<p>本例将用户转账数据大于10000的，作为大额转账记录发出告警。</p>
<p><strong>直接通过启动<code>main</code>即可启动</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FraudDetectionJob</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">StreamExecutionEnvironment</span> <span class="variable">env</span> <span class="operator">=</span> StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        DataStream&lt;Transaction&gt; transactions = env</span><br><span class="line">            .addSource(<span class="keyword">new</span> <span class="title class_">TransactionSource</span>())</span><br><span class="line">            .name(<span class="string">&quot;transactions&quot;</span>);</span><br><span class="line"></span><br><span class="line">        DataStream&lt;Alert&gt; alerts = transactions</span><br><span class="line">            .keyBy(Transaction::getAccountId)</span><br><span class="line">            .process(<span class="keyword">new</span> <span class="title class_">FraudDetector</span>())</span><br><span class="line">            .name(<span class="string">&quot;fraud-detector&quot;</span>);</span><br><span class="line"></span><br><span class="line">        alerts</span><br><span class="line">            .addSink(<span class="keyword">new</span> <span class="title class_">AlertSink</span>())</span><br><span class="line">            .name(<span class="string">&quot;send-alerts&quot;</span>);</span><br><span class="line"></span><br><span class="line">        env.execute(<span class="string">&quot;Fraud Detection&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>步骤：</strong></p>
<ul>
<li><p>创建执行环境</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StreamExecutionEnvironment</span> <span class="variable">env</span> <span class="operator">=</span> StreamExecutionEnvironment.getExecutionEnvironment();</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据源</p>
<blockquote>
<p>指定数据来源，如从数据库、kafka、文件等第三方读取。其中定义数据来源是通过实现<code>SourceFunction</code>实现，在本例中<code>TransactionSource</code>实现了<code>SourceFunction</code>接口，并从数组读取数据。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DataStream&lt;Transaction&gt; transactions = env</span><br><span class="line">    .addSource(<span class="keyword">new</span> <span class="title class_">TransactionSource</span>())</span><br><span class="line">    .name(<span class="string">&quot;transactions&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong><code>TransactionSource.java</code></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionSource</span> <span class="keyword">implements</span> <span class="title class_">SourceFunction</span>&lt;Transaction&gt; &#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Transaction&gt; transactionList = Lists.newArrayList(</span><br><span class="line">			<span class="keyword">new</span> <span class="title class_">Transaction</span>(<span class="string">&quot;NO001&quot;</span>,<span class="number">0.1d</span>),</span><br><span class="line">			<span class="keyword">new</span> <span class="title class_">Transaction</span>(<span class="string">&quot;NO001&quot;</span>,<span class="number">101000d</span>),</span><br><span class="line">			<span class="keyword">new</span> <span class="title class_">Transaction</span>(<span class="string">&quot;NO002&quot;</span>,<span class="number">100d</span>),</span><br><span class="line">			<span class="keyword">new</span> <span class="title class_">Transaction</span>(<span class="string">&quot;NO002&quot;</span>,<span class="number">220d</span>)</span><br><span class="line">	);</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(SourceContext&lt;Transaction&gt; ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="keyword">for</span> (Transaction transaction : transactionList) &#123;</span><br><span class="line">        collector.collect(transaction);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">()</span> &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>Transaction.java</code></strong></p>
<blockquote>
<p>数据实体类，需要实现序列化接口</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Transaction</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">  </span><br><span class="line">	<span class="keyword">private</span> String accountId;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">double</span> amount;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Transaction</span><span class="params">(String accountId, <span class="type">double</span> amount)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.accountId = accountId;</span><br><span class="line">		<span class="built_in">this</span>.amount = amount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getAccountId</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> accountId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getAmount</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> amount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAmount</span><span class="params">(<span class="type">double</span> amount)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.amount = amount;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>数据处理</p>
<blockquote>
<p>处理<code>TransactionSource</code>的生成的数据，其中<code>keyBy(Transaction::getAccountId)</code>是将数据流根据<code>accountId</code>进行分组处理，也就是相同的<code>accountId</code>会在同一个处理线程中处理。数据处理完成后，通过调用<code>Collector#collect</code>接口，将数据传递到下游。本例中，直接生成一个告警信息，传递给下游。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DataStream&lt;FraudDetector.Alert&gt; alerts = transactions</span><br><span class="line">				.keyBy(Transaction::getAccountId)</span><br><span class="line">				.process(<span class="keyword">new</span> <span class="title class_">FraudDetector</span>())</span><br><span class="line">				.name(<span class="string">&quot;fraud-detector&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><code>FraudDetector.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FraudDetector</span> <span class="keyword">extends</span> <span class="title class_">KeyedProcessFunction</span>&lt;Long, Transaction, Alert&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processElement</span><span class="params">(</span></span><br><span class="line"><span class="params">            Transaction transaction,</span></span><br><span class="line"><span class="params">            Context context,</span></span><br><span class="line"><span class="params">            Collector&lt;Alert&gt; collector)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">      <span class="keyword">if</span> (transaction.getAmount() &gt; <span class="number">10000d</span>) &#123;</span><br><span class="line">            <span class="type">Alert</span> <span class="variable">alert</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Alert</span>();</span><br><span class="line">            alert.setId(transaction.getAccountId());</span><br><span class="line">            collector.collect(alert);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>输出结果</p>
<blockquote>
<p>指定输出端，输出端需要实现<code>SinkFunction</code>接口，并实现<code>invoke</code>方法，用于处理输出的数据。本例中<code>AlertSink</code>实现<code>SinkFunction</code>接口，将告警数据打印到控制台，在实际处理中，可将数据保存到数据库、kafka、或者调用网络接口。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alerts.addSink(<span class="keyword">new</span> <span class="title class_">AlertSink</span>())</span><br><span class="line">				.name(<span class="string">&quot;send-alerts&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><code>AlertSink.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AlertSink</span> <span class="keyword">implements</span> <span class="title class_">SinkFunction</span>&lt;Alert&gt; &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(Alert value, Context context)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;alert : &quot;</span> + value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-基于flink-table-api"><a href="#2-基于flink-table-api" class="headerlink" title="2. 基于flink table api"></a>2. 基于flink table api</h2><blockquote>
<p>flink 提供基于table api，进行批处理和流出来统一关系型api，也就是我们不用关注底层的数据层的差异，将物理层数据结构，抽象映射成逻辑层table，对通过table api（以及直接通过SQL）对数据进行处理</p>
</blockquote>
<p><strong>运行环境</strong></p>
<ul>
<li><p>maven</p>
<blockquote>
<p>在基于<code>flink DataStream</code>的依赖基础上，还需要以下依赖</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-table-api-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-table-api-java-bridge_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-table-planner_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-table-planner-blink_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>案例</strong></p>
<blockquote>
<p>本例将CSV文件中的数据读取，其数据格式为：用户id,商品,数量 ，下面我们需要计算出每个用户，各类型商品总共购买了多少</p>
<p><strong>通过启动<code>main</code>即可启动</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">File2PrintExample</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="type">StreamExecutionEnvironment</span> <span class="variable">env</span> <span class="operator">=</span> StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">		<span class="type">TableEnvironment</span> <span class="variable">tEnv</span> <span class="operator">=</span> StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line">		<span class="type">String</span> <span class="variable">contents</span> <span class="operator">=</span> <span class="string">&quot;1,diaper,3\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;1,diaper,4\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;2,pen,3\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;2,rubber,3\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;3,rubber,2\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;4,beer,1&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> createTempFile(contents);</span><br><span class="line"></span><br><span class="line">		<span class="type">String</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE orders (\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  user_id INT,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  product STRING,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  amount INT\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;) WITH (\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  &#x27;connector.type&#x27; = &#x27;filesystem&#x27;,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  &#x27;connector.path&#x27; = &#x27;&quot;</span> + path + <span class="string">&quot;&#x27;,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  &#x27;format.type&#x27; = &#x27;csv&#x27;\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;)&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="type">String</span> <span class="variable">print</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE print (\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  user_id INT,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  product STRING,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  amount INT\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;) WITH (\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;  &#x27;connector&#x27; = &#x27;print&#x27;\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot;)&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">query</span> <span class="operator">=</span> <span class="string">&quot; insert into print SELECT\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot; user_id,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot; product,\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot; sum(amount) as amount\n&quot;</span> +</span><br><span class="line">				<span class="string">&quot; FROM orders group by user_id ,product&quot;</span>;</span><br><span class="line">		tEnv.executeSql(orders);</span><br><span class="line">		tEnv.executeSql(print);</span><br><span class="line">		tEnv.executeSql(query);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Creates a temporary file with the contents and returns the absolute path.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">createTempFile</span><span class="params">(String contents)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		<span class="type">File</span> <span class="variable">tempFile</span> <span class="operator">=</span> File.createTempFile(<span class="string">&quot;orders&quot;</span>, <span class="string">&quot;.csv&quot;</span>);</span><br><span class="line">		tempFile.deleteOnExit();</span><br><span class="line">		FileUtils.writeFileUtf8(tempFile, contents);</span><br><span class="line">		<span class="keyword">return</span> tempFile.toURI().toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>步骤</strong></p>
<ul>
<li><p>创建执行环境</p>
<blockquote>
<p>创建一个执行环境，该环境表示当前执行程序的上下文。如果程序是独立调用的，则此方法返回一个本地执行环境</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StreamExecutionEnvironment</span> <span class="variable">env</span> <span class="operator">=</span> StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"><span class="type">TableEnvironment</span> <span class="variable">tEnv</span> <span class="operator">=</span> StreamTableEnvironment.create(env);</span><br></pre></td></tr></table></figure>
</li>
<li><p>注册表</p>
<blockquote>
<p>接下来将Table注册到当前环境，我们可以使用表连接到外部存储系统，并通过使用table api，访问外出存储数据。如订阅kafka消息、将数据写入到关系型数据库、发送告警等。本例中<code>order</code>表用于读取CSV中的数据，<code>print</code>表用于将处理后的数据，输出到控制台。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE orders (\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  user_id INT,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  product STRING,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  amount INT\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;) WITH (\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  &#x27;connector.type&#x27; = &#x27;filesystem&#x27;,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  &#x27;connector.path&#x27; = &#x27;&quot;</span> + path + <span class="string">&quot;&#x27;,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  &#x27;format.type&#x27; = &#x27;csv&#x27;\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;)&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">	<span class="type">String</span> <span class="variable">print</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE print (\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  user_id INT,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  product STRING,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  amount INT\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;) WITH (\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;  &#x27;connector&#x27; = &#x27;print&#x27;\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot;)&quot;</span>;</span><br><span class="line">  tEnv.executeSql(orders);</span><br><span class="line">	tEnv.executeSql(print);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询</p>
<blockquote>
<p>将表注册后，就可以通过table ap读取数据，并通过函数处理数据，最后输出到目标端。下面两种方式，处理结果相同</p>
</blockquote>
<ol>
<li>通过table api</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Table</span> <span class="variable">ordersTable</span> <span class="operator">=</span> tEnv.from(<span class="string">&quot;orders&quot;</span>)</span><br><span class="line">		.groupBy($(<span class="string">&quot;user_id&quot;</span>), $(<span class="string">&quot;product&quot;</span>))</span><br><span class="line">		.select(</span><br><span class="line">				$(<span class="string">&quot;user_id&quot;</span>),</span><br><span class="line">				$(<span class="string">&quot;product&quot;</span>),</span><br><span class="line">				$(<span class="string">&quot;amount&quot;</span>).sum().as(<span class="string">&quot;amount&quot;</span>));</span><br><span class="line">ordersTable.executeInsert(<span class="string">&quot;print&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过sql</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">query</span> <span class="operator">=</span> <span class="string">&quot; insert into print SELECT\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot; user_id,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot; product,\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot; sum(amount) as amount\n&quot;</span> +</span><br><span class="line">			<span class="string">&quot; FROM orders group by user_id ,product&quot;</span>;</span><br><span class="line">tEnv.executeSql(query);</span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">vhicool</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/flink/flink-start/">http://example.com/flink/flink-start/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">二九的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java</a><a class="post-meta__tags" href="/tags/flink/">flink</a><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></div><div class="post-share"><div class="social-share" data-image="/img/dog.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/kafka/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="常用命令"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">常用命令</div></div><div class="info-2"><div class="info-item-1">主题 创建主题  –zookeeper 会绕过 Kafka 的安全体系。这就是说，即使你为 Kafka 集群设置了安全认证，限制了主题的创建，如果你使用 –zookeeper 的命令，依然能成功创建任意主题，不受认证体系的约束  1bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 2 --topic test   直接使用–bootstrap-server 与集群进行交互  1bin/kafka-topics.sh --bootstrap-server broker_host:port --create --topic my_topic_name  --partitions 1 --replication-factor 1  发送消息 1bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test  查询指定topic 1bin/kafka-topics.sh...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/kafka/kafka%E8%B0%83%E4%BC%98/" title="kafka调优"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-07</div><div class="info-item-2">kafka调优</div></div><div class="info-2"><div class="info-item-1">操作系统调优 挂载（Mount）文件系统时禁掉 atime 更新 atime 的全称是 access time，记录的是文件最后被访问的时间。记录 atime 需要操作系统访问 inode 资源，而禁掉 atime 可以避免 inode 访问时间的写入操作，减少文件系统的写操作数。你可以执行 mount -o noatime 命令进行设置。  文件系统选择  至少选择ext4 或 XFS，尤其是 XFS 文件系统，它具有高性能、高伸缩性等特点，特别适用于生产服务器。  ZFS 多级缓存的机制能够帮助 Kafka 改善 I&#x2F;O 性能    swap 空间的设置 建议将swappiness 设置成一个很小的值，比如 1～10 之间，以防止 Linux 的 OOM Killer 开启随意杀掉进程 临时设置：sudo sysctl vm.swappiness&#x3D;N 永久设置：修改 &#x2F;etc&#x2F;sysctl.conf 文件，增加 vm.swappiness&#x3D;N，然后重启机器  ulimit -n 如果设置得太小，你会碰到 Too Many...</div></div></div></a><a class="pagination-related" href="/kafka/%E4%BD%8D%E7%82%B9%E4%B8%BB%E9%A2%98-_consumer_offsets/" title="位点主题-_consumer_offsets"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-07</div><div class="info-item-2">位点主题-_consumer_offsets</div></div><div class="info-2"><div class="info-item-1">和创建的其他主题一样，位移主题就是普通的 Kafka 主题 位移主题中的消息本质为KV结构，  key保存了3部分内容：group ID、主题名、分区号。 value保存格式有3种 位移值 用于保存 Consumer Group 信息：用来注册 Consumer Group 删除 Group 过期位移甚至是删除 Group 的消息：tombstone 消息，即墓碑消息，也称 delete mark。一旦某个 Consumer Group 下的所有 Consumer 实例都停止了，而且它们的位移数据都已被删除时，Kafka 会向位移主题的对应分区写入 tombstone 消息，表明要彻底删除这个 Group 的信息。    位移主题创建时机当 Kafka 集群中的第一个 Consumer 程序启动时，Kafka 会自动创建位移主题。 分区数：如果是 Kafka 自动创建的，按照Broker 端参数 offsets.topic.num.partitions 的取值，它的默认值是 50。 副本数： Broker 端另一个参数...</div></div></div></a><a class="pagination-related" href="/kafka/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="常用命令"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-07</div><div class="info-item-2">常用命令</div></div><div class="info-2"><div class="info-item-1">主题 创建主题  –zookeeper 会绕过 Kafka 的安全体系。这就是说，即使你为 Kafka 集群设置了安全认证，限制了主题的创建，如果你使用 –zookeeper 的命令，依然能成功创建任意主题，不受认证体系的约束  1bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 2 --topic test   直接使用–bootstrap-server 与集群进行交互  1bin/kafka-topics.sh --bootstrap-server broker_host:port --create --topic my_topic_name  --partitions 1 --replication-factor 1  发送消息 1bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test  查询指定topic 1bin/kafka-topics.sh...</div></div></div></a><a class="pagination-related" href="/kafka/%E6%97%A0%E6%B6%88%E6%81%AF%E4%B8%A2%E5%A4%B1/" title="无消息丢失"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-07</div><div class="info-item-2">无消息丢失</div></div><div class="info-2"><div class="info-item-1">Kafka 只对“已提交”的消息（committed message）做有限度的持久化保证。  已提交 Broker 成功地接收到一条消息并写入到日志文件后，它们会告诉生产者程序这条消息已成功提交。此时，这条消息在 Kafka 看来就正式变为“已提交”消息了。  有限度的持久化保证Kafka 不可能保证在任何情况下都做到不丢失消息。假如你的消息保存在 N 个 Kafka Broker 上，那么这个前提条件就是这 N 个 Broker 中至少有 1 个存活。只要这个条件成立，Kafka 就能保证你的这条消息永远不会丢失。   最佳实践 不要使用 producer.send(msg)，而要使用 producer.send(msg, callback)。记住，一定要使用带有回调通知的 send 方法。 设置 acks = all。acks 是 Producer 的一个参数，代表了你对“已提交”消息的定义。如果设置成 all，则表明所有副本 Broker...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/dog.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">vhicool</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">这是二九的博客，二九是我的可爱的小狗，这个博客用来记录我的学习笔记，以及技术分享</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text">快速开始</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E4%BA%8Eflink-DataStream"><span class="toc-number">1.1.</span> <span class="toc-text">1. 基于flink DataStream</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8Eflink-table-api"><span class="toc-number">1.2.</span> <span class="toc-text">2. 基于flink table api</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/kafka/%E6%97%A0%E6%B6%88%E6%81%AF%E4%B8%A2%E5%A4%B1/" title="无消息丢失">无消息丢失</a><time datetime="2025-07-07T14:21:53.000Z" title="发表于 2025-07-07 22:21:53">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/kafka/%E4%BD%8D%E7%82%B9%E4%B8%BB%E9%A2%98-_consumer_offsets/" title="位点主题-_consumer_offsets">位点主题-_consumer_offsets</a><time datetime="2025-07-07T14:19:37.000Z" title="发表于 2025-07-07 22:19:37">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/kafka/kafka%E8%B0%83%E4%BC%98/" title="kafka调优">kafka调优</a><time datetime="2025-07-07T14:17:30.000Z" title="发表于 2025-07-07 22:17:30">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/kafka/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="常用命令">常用命令</a><time datetime="2025-07-07T14:05:55.000Z" title="发表于 2025-07-07 22:05:55">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/flink/flink-start/" title="flink 开始">flink 开始</a><time datetime="2025-06-30T15:17:43.000Z" title="发表于 2025-06-30 23:17:43">2025-06-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By vhicool</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>